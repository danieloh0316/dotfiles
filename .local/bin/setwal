#!/bin/sh

WAL_DIR="$XDG_CACHE_HOME/wal"

# seperate into two commands in order to use --no-fehbg flag
wal -nqi "$XDG_DATA_HOME/wallpapers/$1"
feh --bg-fill --no-fehbg "$(< "$WAL_DIR/wal")"

# load colors
COLORS="$WAL_DIR/colors.sh"
[ -f "$COLORS" ] || exit
. "$COLORS"

# set bspwm colors
bspc config normal_border_color "$color1"
bspc config active_border_color "$color2"
bspc config focused_border_color "$color15"
bspc config presel_feedback_color "$color1"

# set alacritty colors
ALACRITTY="$WAL_DIR/colors-alacritty.yml"
printf "colors:\n  primary:\n" > "$ALACRITTY"
printf "    background: '$background'\n" >> "$ALACRITTY"
printf "    foreground: '$foreground'\n" >> "$ALACRITTY"
printf "  normal:\n" >> "$ALACRITTY"
printf "    black: '$color0'\n" >> "$ALACRITTY"
printf "    red: '$color1'\n" >> "$ALACRITTY"
printf "    green: '$color2'\n" >> "$ALACRITTY"
printf "    yellow: '$color3'\n" >> "$ALACRITTY"
printf "    blue: '$color4'\n" >> "$ALACRITTY"
printf "    magenta: '$color5'\n" >> "$ALACRITTY"
printf "    cyan: '$color6'\n" >> "$ALACRITTY"
printf "    white: '$color7'\n" >> "$ALACRITTY"
printf "  bright:\n" >> "$ALACRITTY"
printf "    black: '$color8'\n" >> "$ALACRITTY"
printf "    red: '$color9'\n" >> "$ALACRITTY"
printf "    green: '$color10'\n" >> "$ALACRITTY"
printf "    yellow: '$color11'\n" >> "$ALACRITTY"
printf "    blue: '$color12'\n" >> "$ALACRITTY"
printf "    magenta: '$color13'\n" >> "$ALACRITTY"
printf "    cyan: '$color14'\n" >> "$ALACRITTY"
printf "    white: '$color15'" >> "$ALACRITTY"
